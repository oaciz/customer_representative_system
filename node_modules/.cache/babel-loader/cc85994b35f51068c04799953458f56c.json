{"ast":null,"code":"var _jsxFileName = \"/Users/macbook/Desktop/demo/src/VideoCall.js\";\nimport React, { useRef, useEffect, useState } from 'react';\nimport { db } from './firebase';\nimport { collection, addDoc, onSnapshot, setDoc, doc, getDoc, query, where, deleteDoc } from 'firebase/firestore';\nimport { useHistory } from 'react-router-dom';\nconst VideoCall = () => {\n  const history = useHistory();\n  const localVideoRef = useRef(null);\n  const remoteVideoRef = useRef(null);\n  const [pc, setPc] = useState(null);\n  const [currentUser, setCurrentUser] = useState(null);\n  const [onlineUsers, setOnlineUsers] = useState([]);\n  const [incomingCall, setIncomingCall] = useState(null);\n  const [callActive, setCallActive] = useState(false);\n  const [currentCallDoc, setCurrentCallDoc] = useState(null);\n\n  // User authentication and status\n  useEffect(() => {\n    const checkAuth = async () => {\n      const loggedInUser = localStorage.getItem('currentUser');\n      if (!loggedInUser) {\n        alert('Lütfen önce giriş yapın!');\n        history.push('/login');\n        return;\n      }\n      const user = JSON.parse(loggedInUser);\n      setCurrentUser(user);\n      const userStatusRef = doc(db, 'userStatus', user.email);\n      await setDoc(userStatusRef, {\n        online: true,\n        lastSeen: new Date().toISOString(),\n        email: user.email\n      });\n      window.addEventListener('beforeunload', async () => {\n        await setDoc(userStatusRef, {\n          online: false,\n          lastSeen: new Date().toISOString(),\n          email: user.email\n        });\n      });\n    };\n    checkAuth();\n    return () => {\n      if (currentUser === null || currentUser === void 0 ? void 0 : currentUser.email) {\n        const userStatusRef = doc(db, 'userStatus', currentUser.email);\n        setDoc(userStatusRef, {\n          online: false,\n          lastSeen: new Date().toISOString(),\n          email: currentUser.email\n        });\n      }\n    };\n  }, [history]);\n\n  // Online users and incoming calls\n  useEffect(() => {\n    if (!(currentUser === null || currentUser === void 0 ? void 0 : currentUser.email)) return;\n    const q = query(collection(db, 'userStatus'), where('online', '==', true), where('email', '!=', currentUser.email));\n    const unsubscribe = onSnapshot(q, snapshot => {\n      const users = [];\n      snapshot.forEach(doc => {\n        users.push(doc.data());\n      });\n      setOnlineUsers(users);\n    });\n    const callsQuery = query(collection(db, 'calls'), where('targetUser', '==', currentUser.email), where('status', '==', 'pending'));\n    const callsUnsubscribe = onSnapshot(callsQuery, snapshot => {\n      if (!snapshot.empty) {\n        snapshot.forEach(doc => {\n          setIncomingCall({\n            id: doc.id,\n            ...doc.data()\n          });\n        });\n      } else {\n        setIncomingCall(null);\n      }\n    });\n    return () => {\n      callsUnsubscribe();\n    };\n  }, [currentUser === null || currentUser === void 0 ? void 0 : currentUser.email]);\n\n  // WebRTC connection setup\n  const setupWebRTC = async () => {\n    try {\n      const servers = {\n        iceServers: [{\n          urls: 'stun:stun.l.google.com:19302'\n        }]\n      };\n      const peerConnection = new RTCPeerConnection(servers);\n      setPc(peerConnection);\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true\n      });\n      localVideoRef.current.srcObject = stream;\n      stream.getTracks().forEach(track => peerConnection.addTrack(track, stream));\n      peerConnection.ontrack = event => {\n        remoteVideoRef.current.srcObject = event.streams[0];\n      };\n      return peerConnection;\n    } catch (error) {\n      console.error('WebRTC kurulumu sırasında hata:', error);\n    }\n  };\n\n  // Start a call\n  const callUser = async targetUser => {\n    const peerConnection = await setupWebRTC();\n    setCallActive(true);\n    const callDoc = doc(collection(db, 'calls'));\n    setCurrentCallDoc(callDoc);\n    const offerCandidates = collection(callDoc, 'offerCandidates');\n    const answerCandidates = collection(callDoc, 'answerCandidates');\n    peerConnection.onicecandidate = event => {\n      if (event.candidate) {\n        addDoc(offerCandidates, event.candidate.toJSON());\n      }\n    };\n    const offerDescription = await peerConnection.createOffer();\n    await peerConnection.setLocalDescription(offerDescription);\n    await setDoc(callDoc, {\n      offer: {\n        sdp: offerDescription.sdp,\n        type: offerDescription.type\n      },\n      createdBy: currentUser.email,\n      targetUser: targetUser.email,\n      status: 'pending',\n      createdAt: new Date().toISOString()\n    });\n\n    // Parallelize offer-answer and candidate exchange\n    const handleOfferAnswer = async () => {\n      const data = (await getDoc(callDoc)).data();\n      if ((data === null || data === void 0 ? void 0 : data.answer) && !peerConnection.currentRemoteDescription) {\n        const answerDescription = new RTCSessionDescription(data.answer);\n        await peerConnection.setRemoteDescription(answerDescription);\n      }\n    };\n    handleOfferAnswer();\n    onSnapshot(answerCandidates, snapshot => {\n      snapshot.docChanges().forEach(change => {\n        if (change.type === 'added') {\n          const candidate = new RTCIceCandidate(change.doc.data());\n          peerConnection.addIceCandidate(candidate);\n        }\n      });\n    });\n  };\n\n  // Answer an incoming call\n  const answerCall = async () => {\n    if (!incomingCall) return;\n    const peerConnection = await setupWebRTC();\n    setCallActive(true);\n    const callDoc = doc(db, 'calls', incomingCall.id);\n    setCurrentCallDoc(callDoc);\n    const answerCandidates = collection(callDoc, 'answerCandidates');\n    const offerCandidates = collection(callDoc, 'offerCandidates');\n    peerConnection.onicecandidate = event => {\n      if (event.candidate) {\n        addDoc(answerCandidates, event.candidate.toJSON());\n      }\n    };\n    const callData = (await getDoc(callDoc)).data();\n    const offerDescription = callData.offer;\n    await peerConnection.setRemoteDescription(new RTCSessionDescription(offerDescription));\n    const answerDescription = await peerConnection.createAnswer();\n    await peerConnection.setLocalDescription(answerDescription);\n    await setDoc(callDoc, {\n      answer: {\n        sdp: answerDescription.sdp,\n        type: answerDescription.type\n      },\n      status: 'answered'\n    }, {\n      merge: true\n    });\n    onSnapshot(offerCandidates, snapshot => {\n      snapshot.docChanges().forEach(change => {\n        if (change.type === 'added') {\n          const candidate = new RTCIceCandidate(change.doc.data());\n          peerConnection.addIceCandidate(candidate);\n        }\n      });\n    });\n    setIncomingCall(null);\n  };\n\n  // End the call\n  const endCall = async () => {\n    if (pc) {\n      pc.close();\n      setPc(null);\n    }\n    if (localVideoRef.current && localVideoRef.current.srcObject) {\n      localVideoRef.current.srcObject.getTracks().forEach(track => track.stop());\n      localVideoRef.current.srcObject = null;\n    }\n    if (remoteVideoRef.current && remoteVideoRef.current.srcObject) {\n      remoteVideoRef.current.srcObject.getTracks().forEach(track => track.stop());\n      remoteVideoRef.current.srcObject = null;\n    }\n    setCallActive(false);\n    if (currentCallDoc) {\n      await setDoc(currentCallDoc, {\n        status: 'ended'\n      }, {\n        merge: true\n      });\n      setCurrentCallDoc(null);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"video-call-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 7\n    }\n  }, \"Video G\\xF6r\\xFC\\u015Fmesi\"), currentUser && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"user-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 23\n    }\n  }, \"Kullan\\u0131c\\u0131: \", currentUser.email), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"online-users-section\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 9\n    }\n  }, \"\\xC7evrimi\\xE7i Kullan\\u0131c\\u0131lar (\", onlineUsers.length, \")\"), onlineUsers.length === 0 ? /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 11\n    }\n  }, \"\\u015Eu anda \\xE7evrimi\\xE7i kullan\\u0131c\\u0131 bulunmuyor.\") : /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"users-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 11\n    }\n  }, onlineUsers.map(user => /*#__PURE__*/React.createElement(\"li\", {\n    key: user.email,\n    className: \"user-item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 17\n    }\n  }, user.email), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => callUser(user),\n    disabled: !currentUser || callActive,\n    className: \"call-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 17\n    }\n  }, \"Ara\"))))), incomingCall && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"incoming-call\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 11\n    }\n  }, \"Gelen Arama\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: answerCall,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 11\n    }\n  }, \"Cevapla\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"video-call-controls\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 7\n    }\n  }, callActive && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"video-call\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"video\", {\n    ref: localVideoRef,\n    autoPlay: true,\n    muted: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"video\", {\n    ref: remoteVideoRef,\n    autoPlay: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: endCall,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 13\n    }\n  }, \"Sonland\\u0131r\"))));\n};\nexport default VideoCall;","map":{"version":3,"names":["React","useRef","useEffect","useState","db","collection","addDoc","onSnapshot","setDoc","doc","getDoc","query","where","deleteDoc","useHistory","VideoCall","history","localVideoRef","remoteVideoRef","pc","setPc","currentUser","setCurrentUser","onlineUsers","setOnlineUsers","incomingCall","setIncomingCall","callActive","setCallActive","currentCallDoc","setCurrentCallDoc","checkAuth","loggedInUser","localStorage","getItem","alert","push","user","JSON","parse","userStatusRef","email","online","lastSeen","Date","toISOString","window","addEventListener","q","unsubscribe","snapshot","users","forEach","data","callsQuery","callsUnsubscribe","empty","id","setupWebRTC","servers","iceServers","urls","peerConnection","RTCPeerConnection","stream","navigator","mediaDevices","getUserMedia","video","audio","current","srcObject","getTracks","track","addTrack","ontrack","event","streams","error","console","callUser","targetUser","callDoc","offerCandidates","answerCandidates","onicecandidate","candidate","toJSON","offerDescription","createOffer","setLocalDescription","offer","sdp","type","createdBy","status","createdAt","handleOfferAnswer","answer","currentRemoteDescription","answerDescription","RTCSessionDescription","setRemoteDescription","docChanges","change","RTCIceCandidate","addIceCandidate","answerCall","callData","createAnswer","merge","endCall","close","stop","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","length","map","key","onClick","disabled","ref","autoPlay","muted"],"sources":["/Users/macbook/Desktop/demo/src/VideoCall.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport { db } from './firebase';\nimport { collection, addDoc, onSnapshot, setDoc, doc, getDoc, query, where, deleteDoc } from 'firebase/firestore';\nimport { useHistory } from 'react-router-dom';\n\nconst VideoCall = () => {\n  const history = useHistory();\n  const localVideoRef = useRef(null);\n  const remoteVideoRef = useRef(null);\n  const [pc, setPc] = useState(null);\n  const [currentUser, setCurrentUser] = useState(null);\n  const [onlineUsers, setOnlineUsers] = useState([]);\n  const [incomingCall, setIncomingCall] = useState(null);\n  const [callActive, setCallActive] = useState(false);\n  const [currentCallDoc, setCurrentCallDoc] = useState(null);\n\n  // User authentication and status\n  useEffect(() => {\n    const checkAuth = async () => {\n      const loggedInUser = localStorage.getItem('currentUser');\n      if (!loggedInUser) {\n        alert('Lütfen önce giriş yapın!');\n        history.push('/login');\n        return;\n      }\n      const user = JSON.parse(loggedInUser);\n      setCurrentUser(user);\n\n      const userStatusRef = doc(db, 'userStatus', user.email);\n      await setDoc(userStatusRef, { \n        online: true,\n        lastSeen: new Date().toISOString(),\n        email: user.email\n      });\n\n      window.addEventListener('beforeunload', async () => {\n        await setDoc(userStatusRef, { \n          online: false,\n          lastSeen: new Date().toISOString(),\n          email: user.email\n        });\n      });\n    };\n\n    checkAuth();\n\n    return () => {\n      if (currentUser?.email) {\n        const userStatusRef = doc(db, 'userStatus', currentUser.email);\n        setDoc(userStatusRef, {\n          online: false,\n          lastSeen: new Date().toISOString(),\n          email: currentUser.email\n        });\n      }\n    };\n  }, [history]);\n\n  // Online users and incoming calls\n  useEffect(() => {\n    if (!currentUser?.email) return;\n\n    const q = query(\n      collection(db, 'userStatus'),\n      where('online', '==', true),\n      where('email', '!=', currentUser.email)\n    );\n\n    const unsubscribe = onSnapshot(q, (snapshot) => {\n      const users = [];\n      snapshot.forEach((doc) => {\n        users.push(doc.data());\n      });\n      setOnlineUsers(users);\n    });\n\n    const callsQuery = query(\n      collection(db, 'calls'),\n      where('targetUser', '==', currentUser.email),\n      where('status', '==', 'pending')\n    );\n\n    const callsUnsubscribe = onSnapshot(callsQuery, (snapshot) => {\n      if (!snapshot.empty) {\n        snapshot.forEach((doc) => {\n          setIncomingCall({\n            id: doc.id,\n            ...doc.data(),\n          });\n        });\n      } else {\n        setIncomingCall(null);\n      }\n    });\n\n    return () => {\n      callsUnsubscribe();\n    };\n  }, [currentUser?.email]);\n\n  // WebRTC connection setup\n  const setupWebRTC = async () => {\n    try {\n      const servers = {\n        iceServers: [{ urls: 'stun:stun.l.google.com:19302' }],\n      };\n\n      const peerConnection = new RTCPeerConnection(servers);\n      setPc(peerConnection);\n\n      const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\n      localVideoRef.current.srcObject = stream;\n      stream.getTracks().forEach(track => peerConnection.addTrack(track, stream));\n\n      peerConnection.ontrack = (event) => {\n        remoteVideoRef.current.srcObject = event.streams[0];\n      };\n\n      return peerConnection;\n    } catch (error) {\n      console.error('WebRTC kurulumu sırasında hata:', error);\n    }\n  };\n\n  // Start a call\n  const callUser = async (targetUser) => {\n    const peerConnection = await setupWebRTC();\n    setCallActive(true);\n\n    const callDoc = doc(collection(db, 'calls'));\n    setCurrentCallDoc(callDoc);\n    const offerCandidates = collection(callDoc, 'offerCandidates');\n    const answerCandidates = collection(callDoc, 'answerCandidates');\n\n    peerConnection.onicecandidate = (event) => {\n      if (event.candidate) {\n        addDoc(offerCandidates, event.candidate.toJSON());\n      }\n    };\n\n    const offerDescription = await peerConnection.createOffer();\n    await peerConnection.setLocalDescription(offerDescription);\n\n    await setDoc(callDoc, {\n      offer: {\n        sdp: offerDescription.sdp,\n        type: offerDescription.type,\n      },\n      createdBy: currentUser.email,\n      targetUser: targetUser.email,\n      status: 'pending',\n      createdAt: new Date().toISOString()\n    });\n\n    // Parallelize offer-answer and candidate exchange\n    const handleOfferAnswer = async () => {\n      const data = (await getDoc(callDoc)).data();\n      if (data?.answer && !peerConnection.currentRemoteDescription) {\n        const answerDescription = new RTCSessionDescription(data.answer);\n        await peerConnection.setRemoteDescription(answerDescription);\n      }\n    };\n    handleOfferAnswer();\n\n    onSnapshot(answerCandidates, (snapshot) => {\n      snapshot.docChanges().forEach((change) => {\n        if (change.type === 'added') {\n          const candidate = new RTCIceCandidate(change.doc.data());\n          peerConnection.addIceCandidate(candidate);\n        }\n      });\n    });\n  };\n\n  // Answer an incoming call\n  const answerCall = async () => {\n    if (!incomingCall) return;\n\n    const peerConnection = await setupWebRTC();\n    setCallActive(true);\n    const callDoc = doc(db, 'calls', incomingCall.id);\n    setCurrentCallDoc(callDoc);\n    const answerCandidates = collection(callDoc, 'answerCandidates');\n    const offerCandidates = collection(callDoc, 'offerCandidates');\n\n    peerConnection.onicecandidate = (event) => {\n      if (event.candidate) {\n        addDoc(answerCandidates, event.candidate.toJSON());\n      }\n    };\n\n    const callData = (await getDoc(callDoc)).data();\n    const offerDescription = callData.offer;\n    await peerConnection.setRemoteDescription(new RTCSessionDescription(offerDescription));\n\n    const answerDescription = await peerConnection.createAnswer();\n    await peerConnection.setLocalDescription(answerDescription);\n\n    await setDoc(callDoc, {\n      answer: {\n        sdp: answerDescription.sdp,\n        type: answerDescription.type,\n      },\n      status: 'answered'\n    }, { merge: true });\n\n    onSnapshot(offerCandidates, (snapshot) => {\n      snapshot.docChanges().forEach((change) => {\n        if (change.type === 'added') {\n          const candidate = new RTCIceCandidate(change.doc.data());\n          peerConnection.addIceCandidate(candidate);\n        }\n      });\n    });\n\n    setIncomingCall(null);\n  };\n\n  // End the call\n  const endCall = async () => {\n    if (pc) {\n      pc.close();\n      setPc(null);\n    }\n\n    if (localVideoRef.current && localVideoRef.current.srcObject) {\n      localVideoRef.current.srcObject.getTracks().forEach(track => track.stop());\n      localVideoRef.current.srcObject = null;\n    }\n\n    if (remoteVideoRef.current && remoteVideoRef.current.srcObject) {\n      remoteVideoRef.current.srcObject.getTracks().forEach(track => track.stop());\n      remoteVideoRef.current.srcObject = null;\n    }\n\n    setCallActive(false);\n\n    if (currentCallDoc) {\n      await setDoc(currentCallDoc, { status: 'ended' }, { merge: true });\n      setCurrentCallDoc(null);\n    }\n  };\n\n  return (\n    <div className=\"video-call-container\">\n      <h2>Video Görüşmesi</h2>\n      {currentUser && <p className=\"user-info\">Kullanıcı: {currentUser.email}</p>}\n      \n      <div className=\"online-users-section\">\n        <h3>Çevrimiçi Kullanıcılar ({onlineUsers.length})</h3>\n        {onlineUsers.length === 0 ? (\n          <p>Şu anda çevrimiçi kullanıcı bulunmuyor.</p>\n        ) : (\n          <ul className=\"users-list\">\n            {onlineUsers.map((user) => (\n              <li key={user.email} className=\"user-item\">\n                <span>{user.email}</span>\n                <button \n                  onClick={() => callUser(user)}\n                  disabled={!currentUser || callActive}\n                  className=\"call-button\"\n                >\n                  Ara\n                </button>\n              </li>\n            ))}\n          </ul>\n        )}\n      </div>\n\n      {incomingCall && (\n        <div className=\"incoming-call\">\n          <h3>Gelen Arama</h3>\n          <button onClick={answerCall}>Cevapla</button>\n        </div>\n      )}\n\n      <div className=\"video-call-controls\">\n        {callActive && (\n          <div className=\"video-call\">\n            <video ref={localVideoRef} autoPlay muted />\n            <video ref={remoteVideoRef} autoPlay />\n            <button onClick={endCall}>Sonlandır</button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default VideoCall;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}